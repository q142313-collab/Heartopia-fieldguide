const pokedex = document.getElementById(\'pokedex\');\nconst addGuideBtn = document.getElementById(\'add-guide-btn\');\nconst filterBtns = document.querySelectorAll(\'.filter-btn\');\nconst modal = document.getElementById(\'add-guide-modal\');\nconst closeBtn = document.querySelector(\'.close-btn\');\nconst addGuideForm = document.getElementById(\'add-guide-form\');\nconst imageDropZone = document.getElementById(\'image-drop-zone\');\nconst creatureImageInput = document.getElementById(\'creature-image\');\nconst langBtns = document.querySelectorAll(\'.lang-btn\');\n\nlet guides = JSON.parse(localStorage.getItem(\'guides\')) || [];\nlet currentFilter = null;\nlet currentLang = \'en\';\n\nconst setLanguage = (lang) => {\n  currentLang = lang;\n  document.querySelectorAll(\'[data-translate-key]\').forEach(el => {\n    const key = el.dataset.translateKey;\n    el.textContent = translations[lang][key];\n  });\n  document.querySelectorAll(\'[data-translate-key-placeholder]\').forEach(el => {\n    const key = el.dataset.translateKeyPlaceholder;\n    el.placeholder = translations[lang][key];\n  });\n};\n\nconst displayGuides = () => {\n  const filteredGuides = currentFilter ? guides.filter(guide => guide.category === currentFilter) : guides;\n  const guidesHTMLString = filteredGuides\n    .map(\n      (guide) => `\n    <div class=\"pokemon-card\">\n      <img src=\"${guide.image}\" />\n      <h2>${guide.name}</h2>\n      <p><strong>Region:</strong> ${guide.region}</p>\n      <p><strong>Sub-region:</strong> ${guide.subRegion}</p>\n      <p><strong>Level:</strong> ${guide.level}</p>\n      <p><strong>Weather:</strong> ${guide.weather}</p>\n      <p><strong>Time:</strong> ${guide.time}</p>\n    </div>\n    `\n    )\n    .join(\'\');\n  pokedex.innerHTML = guidesHTMLString;\n};\n\nconst toggleModal = (show) => {\n  modal.style.display = show ? \'block\' : \'none\';\n};\n\nconst handleImageFile = (file) => {\n  const reader = new FileReader();\n  reader.onload = (e) => {\n    creatureImageInput.dataset.url = e.target.result;\n    imageDropZone.querySelector(\'p\').textContent = file.name;\n  };\n  reader.readAsDataURL(file);\n};\n\nconst parseHTML = (html, category) => {\n  const parser = new DOMParser();\n  const doc = parser.parseFromString(html, \'text/html\');\n  const rows = doc.querySelectorAll(\'tr\');\n  const newGuides = [];\n  for (let i = 1; i < rows.length; i++) {\n    const cells = rows[i].querySelectorAll(\'td\');\n    if (cells.length === 8) {\n      newGuides.push({\n        name: cells[0].textContent,\n        region: cells[1].textContent,\n        subRegion: cells[2].textContent,\n        level: cells[3].textContent,\n        weather: cells[4].textContent,\n        time: cells[5].textContent,\n        image: \`.vscode/fieldhuide/${cells[7].textContent}`,\n        category: category,\n      });\n    }\n  }\n  return newGuides;\n};\n\nconst loadInitialData = async () => {\n  if (guides.length === 0) {\n    const fishHTML = await fetch(\'.vscode/fieldhuide/어류.html\').then(res => res.text());\n    const birdHTML = await fetch(\'.vscode/fieldhuide/조류.html\').then(res => res.text());\n    const insectHTML = await fetch(\'.vscode/fieldhuide/곤충.html\').then(res => res.text());\n\n    const fishGuides = parseHTML(fishHTML, \'fish\');\n    const birdGuides = parseHTML(birdHTML, \'bird\');\n    const insectGuides = parseHTML(insectHTML, \'insect\');\n\n    guides = [...fishGuides, ...birdGuides, ...insectGuides];\n    localStorage.setItem(\'guides\', JSON.stringify(guides));\n    displayGuides();\n  }\n};\n\nimageDropZone.addEventListener(\'click\', () => creatureImageInput.click());\ncreatureImageInput.addEventListener(\'change\', (e) => handleImageFile(e.target.files[0]));\n\nimageDropZone.addEventListener(\'dragover\', (e) => {\n  e.preventDefault();\n  imageDropZone.style.borderColor = \'#c0392b\';\n});\n\nimageDropZone.addEventListener(\'dragleave\', (e) => {\n  e.preventDefault();\n  imageDropZone.style.borderColor = \'#ccc\';\n});\n\nimageDropZone.addEventListener(\'drop\', (e) => {\n  e.preventDefault();\n  imageDropZone.style.borderColor = \'#ccc\';\n  handleImageFile(e.dataTransfer.files[0]);\n});\n\naddGuideBtn.addEventListener(\'click\', () => toggleModal(true));\ncloseBtn.addEventListener(\'click\', () => toggleModal(false));\nwindow.addEventListener(\'click\', (e) => {\n  if (e.target === modal) {\n    toggleModal(false);\n  }\n});\n\naddGuideForm.addEventListener(\'submit\', (e) => {\n  e.preventDefault();\n  const newGuide = {\n    name: document.getElementById(\'creature-name\').value,\n    region: document.getElementById(\'creature-region\').value,\n    subRegion: document.getElementById(\'creature-sub-region\').value,\n    level: document.getElementById(\'creature-level\').value,\n    weather: document.getElementById(\'creature-weather\').value,\n    time: document.getElementById(\'creature-time\').value,\n    image: creatureImageInput.dataset.url,\n    category: document.getElementById(\'creature-category\').value,\n  };\n  guides.push(newGuide);\n  localStorage.setItem(\'guides\', JSON.stringify(guides));\n  displayGuides();\n  toggleModal(false);\n  addGuideForm.reset();\n  imageDropZone.querySelector(\'p\').textContent = \'Drag & Drop image here or click to select\';\n  delete creatureImageInput.dataset.url;\n});\n\nfilterBtns.forEach(btn => {\n  btn.addEventListener(\'click\', () => {\n    const category = btn.dataset.category;\n    currentFilter = currentFilter === category ? null : category;\n    displayGuides();\n  });\n});\n\nlangBtns.forEach(btn => {\n  btn.addEventListener(\'click\', () => {\n    const lang = btn.dataset.lang;\n    setLanguage(lang);\n  });\n});\n\nloadInitialData().then(() => {\n  setLanguage(currentLang);\n  displayGuides();\n});\n